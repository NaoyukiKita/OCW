# 時系列解析 第１回

## 1-1. イントロダクション

略

## 1-2. 時系列解析とは

### 教科書・参考書・Rパッケージ・サービス

#### 教科書

- 北川源四郎:「時系列解析入門」 岩倉書店(2005)

#### 関連文献

1. 赤池弘次, 中川東一郎:「ダイナミックシステムの統計的解析と制御」改訂版 サイエンス社(2000)
2. 赤池弘次, 北川源四郎編:「時系列解析の実際」1, 2 朝倉書店(1994, 1995)
3. 尾崎統, 北川源四郎編:「時系列解析の方法」朝倉書店(1998)
4. 岩波データサイエンス刊行委員会編, 「時系列解析：状態空間モデル・因果解析・ビジネス応用」岩波データサイエンス6, 岩倉書店(2017)

#### 本講義関連時系列解析用のRパッケージ

- TSSS (Time Series analysis with State Space model)
- Timsac (TIMSAC for R package)
- dlm (An R package for dynamic linear model)
- KFAS (Exponentioal family state space models in R)

#### WebDecomp

時系列解析手法の一部をWebで利用できる

---

### 統計データ

1. 独立な観測データ
    - 調査データ, 治験データ, 多変量解析データ
2. 時系列データ
    - 株価データ, 地震データ, 制御系データ
3. 空間(平面)データ
    - GIS
4. 時空間データ
    - 気象データ, 人口流動データ

---

### 時系列とは

- 時間とともに不規則に変動する現象の記録
  - $n, t$: 観測した時刻(本講義では通常$n$を使う)
  - $y_n, y(n)$: 時刻$n$における観測値(本講義では通常$y_n$を使う)
  - $N, T$: 観測データ数(本講義では通常$N$を使う)
  - $y_1, \cdots y_N$: 時系列
- 世の中の興味あるデータの多くは時系列
- 数学的には, 時系列は時刻をパラメタとする確率変数の実現値と考えるが, 本講義では明確に区別しない
  - $Y_n$: 確率過程
  - $y_n$: 時系列

---

### 時系列解析

- 可視化・特徴把握
  - 時系列を図示したり, 基本的な記述統計量を用いて時系列の特徴や解析結果を簡潔に表現する
- モデリング
  - 時系列の特徴を的確に捉えた時系列モデルを作成する
- 予測・シミュレーション
  - 現在までに得られた情報から今後の変動を予測する
- 情報抽出
  - 時系列から有用な情報を抽出する
- 制御・意思決定
  - 操作可能な変数を適当に変化させ目的とする制御変数が望ましい変動をするように制御すること

### 統計的モデリング

データに加え、理論や経験的知識を組み込んだモデリングを行いたい, またモデリングによって発見された知識によってさらに良いモデルを作成することができるかもしれない. モデリングが最も重要.

## 1-3. 時系列データのプロット

略（1-3.ipynbを参照）

## 1-4. 時系列の前処理（変数変換）

モデリングを容易にするために以下のような前処理を行う:

- 変数変換
- 階差（差分）・季節階差
- 前期比・前年比
- 移動平均・移動メディアン
- 欠損値・異常値

副作用もある. 適切な前処理が重要

### 変数変換

目的

- 線形, 定常, 正規性などを仮定したモデリングを容易にする
- パラメタ最適化を容易にする

例

- 対数変換
- ロジット変換
- Box-Cox変換
- （階差）

数式

変数変換を行う関数を$h: \mathcal{X} \rightarrow \mathcal{Y}$とすると, 確率変数$X, Y$の確率密度関数$f(x), g(x)$について,

$$
\begin{align}
g(y) &= f(h^{-1}(y)) \left| \frac{dh^{-1}}{dy} \right| \nonumber \\
f(x) &= g(h(x)) \left| \frac{dh}{dx} \right| \nonumber
\end{align}
$$

が成立し, 確率分布が変形する. また定義域が変わることもある. 適当な変数変換を行うことで, 確率分布を正規分布に近づけることができる.

1-4 時系列の前処理~05:48
